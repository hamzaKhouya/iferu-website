(function(a){function g(b){var e=[],c=new Set,f=new Set;new Set;0<b.length?h.show():h.hide();console.log("search for "+b);a(".chov__item--highlighted").removeClass("chov__item--highlighted");3<=b.length?(l.forEach(function(d){if(0<=d.title.search(RegExp(b,"i"))||0<=d.synonyms.search(RegExp(b,"i")))d.$el.addClass("chov__item--highlighted"),d.$el.parents(".chov__item-group:not(.chov__item-group--level-0)").each(function(){c.add(a(this).attr("id"))}),f.add(d.$el.closest(".chov__item-group--level-1").attr("data-parent-channel-id")),
e.push(d.title)}),console.log("search for "+b+" finished, hits: "+e),m(0===e.length)):(m(!1),f=n);(new Set(Array.from(p).filter(function(a){return!c.has(a)}))).forEach(function(b){b=a("#"+b);b.attr("aria-expanded")&&b.collapse("hide")});c.forEach(function(b){a("#"+b).collapse("show")})}function m(b){b?a(".chov__search-noresult").removeClass("hidden"):a(".chov__search-noresult").addClass("hidden")}function q(b,e,c){lblFollowing=c.attr("data-ga-channel-follower-label-unfollow");lblFollow=c.attr("data-ga-channel-follower-label-follow");
requestMethod="";requestMethod=c.is(".active")?"DELETE":"POST";a.ajax({url:"/channels/"+b+"/"+e+"/follow",method:requestMethod,success:function(a){a.following?c.text(lblFollowing).toggleClass("active",a.following):c.text(lblFollow).toggleClass("active",a.following)},error:function(b){noty({text:a.parseJSON(b.responseText).message,timeout:2E3,theme:"relax",layout:"center",type:"error"})}})}var l=[],n=new Set,p=new Set,k=a(".chov__search-input"),h=a(".chov__search-btn-clear");a(function(){a(".chov__item").each(function(){var b=
{channelId:a(this).attr("data-channelId"),title:a(this).attr("data-title"),synonyms:a(this).attr("data-synonyms"),$el:a(this)};l.push(b)});a(".chov__item--level-0").each(function(){n.add(a(this).attr("data-channel-id"))});a(".chov__item-group:not(.chov__item-group--level-0)").each(function(){p.add(a(this).attr("id"))});var b=new URLSearchParams(window.location.search);b.has("search")&&(b=b.get("search"),k.val(b),g(b))});k.on("keyup",function(a,e){var c=0;return function(){var f=this,d=arguments;clearTimeout(c);
c=setTimeout(function(){a.apply(f,d)},e||0)}}(function(){g(a(this).val())},500));h.on("click",function(){k.val("");g("")});a(".btnFlwr").on("click",function(){q(a(this).attr("data-channelname"),a(this).attr("data-channelid"),a(this))})})(jQuery);