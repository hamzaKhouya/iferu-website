(function(a,e,g,l){var k={spinner:'\x3cdiv class\x3d"text-center"\x3e\x3cimg src\x3d"/www/images/pleasewait.gif" alt\x3d"Loading..."\x3e\x3c/div\x3e',containerSelector:".searchResultContainer",nextSelector:".searchResultPager a:last",jsFormParams:{outputType:"part"},loadingOpacity:0.5},h=function(b,c){this.$form=a(b);this.options=a.extend({},k,c);this.init()};h.prototype={_jscroll:null,_loading:null,init:function(){var b=this.options,c=this.$form;b.jsFormParams&&(a.each(b.jsFormParams,function(a,
b){c.prepend('\x3cinput type\x3d"hidden" name\x3d"'+a+'" value\x3d"'+b+'"\x3e')}),a(b.nextSelector).attr("href",function(c,d){return d+"\x26"+a.param(b.jsFormParams)}));c.on("submit",a.proxy(this._updateState,this)).on("change spinstop",":checkbox, :radio, input, select",a.proxy(this._updateState,this));a("fieldset",this.$form).each(function(b,d){a(".first",d).append(a('\x3ca class\x3d"toggler" href\x3d"javascript:void(0)"\x3e\x3c/a\x3e').on("click",function(){a(d).toggleClass("collapsed")}))});a("fieldset .first :checkbox:checked").closest("fieldset").toggleClass("collapsed");
a("fieldset",this.$form).each(function(b,d){var c=a(".first :checkbox",d),f=a(".options :checkbox",d),e=a(".options .select select",d);c.on("change",function(){c.prop("checked")?(f.prop("checked",!1),e.val([]).trigger("change.select2")):(f.first().prop("checked",!0),e.val(e.find("option:first").val()).trigger("change.select2"));a(d).toggleClass("collapsed",c.prop("checked"));a("input:not(:checkbox)",f.first().parent()).prop("disabled",!f.first().prop("checked")).filter(".ui-spinner-input").spinner("option",
"disabled",!f.first().prop("checked"))});f.on("change",function(b){var d=f.length;b=a(b.target);a("input:not(:checkbox)",b.parent()).prop("disabled",!b.prop("checked")).filter(".ui-spinner-input").spinner("option","disabled",!b.prop("checked"));f.filter(":checked").length===d&&1<d||!f.filter(":checked").length?(c.prop("checked",!0),f.prop("checked",!1)):c.prop("checked",!1)});e.on("change",function(b){c.prop("checked",!a(b.target).val().length)});f.each(function(b,c){var d=a(c);a("input:not(:checkbox):not([type\x3d'hidden'])",
d.parent()).prop("disabled",!d.prop("checked")).filter(".ui-spinner-input").spinner("option","disabled",!d.prop("checked"))})});this._initScroll();this._initSuggestionLinks();this._isScrolledIntoView(a("#mainTitle"))||a("html, body").animate({scrollTop:a("#mainTitle").offset().top},200);history.replaceState(null,a(g).find("title").text(),this._getFormQS());a(e).on("statechange popstate",a.proxy(this._onStateChange,this))},_updateState:function(b){b&&b.preventDefault&&b.preventDefault();history.pushState(null,
a(g).find("title").text(),this._getFormQS());a(e).trigger("statechange")},_onStateChange:function(){this._populateForm(a.deparam(e.location.search.slice(1)));setTimeout(a.proxy(function(){this._loading&&a(this.options.containerSelector).css("opacity",this.options.loadingOpacity);this._isScrolledIntoView(a("#mainTitle"))||a("html, body").animate({scrollTop:a("#mainTitle").offset().top-15},200)},this),500);this._loading=a.get(this.$form.attr("action"),this.$form.serialize(),a.proxy(this._reloadForm,
this),"html")},_reloadForm:function(b,c,e){this._loading===e&&(a(this.options.containerSelector).html(b).css("opacity","").gaInitGeneral(),this._initScroll(),this._initSuggestionLinks(),this._loading=null)},_getFormQS:function(){var b=this.options;return"?"+a("[name]:not([name^\x3d'_'])",this.$form).filter(function(){return!(this.name in b.jsFormParams)}).serialize()},_populateForm:function(b){var c=this;a("input[type\x3d'checkbox'], input[type\x3d'radio']",this.$form).each(function(){var c=a(this),
d=c.val(),e=b[c.attr("name")],d=a.isArray(e)?-1<a.inArray(d,e):e==d;c.prop("checked",d)});a.each(b,function(b,d){a("[name\x3d'"+b+"']:not([type\x3d'checkbox']):not([type\x3d'radio'])",c.$form).val(d)})},_isScrolledIntoView:function(b){var c=a(e).scrollTop(),g=c+a(e).height()/2,d=a(b).offset().top;return d+a(b).height()<=g&&d>=c},_initScroll:function(){var b=this.options;!this._jscroll||this._jscroll.jscroll.destroy();this._jscroll=a(b.containerSelector).jscroll({loadingHtml:b.spinner,padding:300,
nextSelector:b.nextSelector,callback:function(){a(b.containerSelector).find(".row:last").gaInitGeneral()}})},_initSuggestionLinks:function(){var b=this;a(this.options.containerSelector+" .searchSuggestion").on("click",function(c){c.preventDefault();if(c=a(c.target).data("gaSearchSuggestion"))a("input[name\x3dquery]",b.$form).val(c),b.$form.trigger("submit")})}};a.fn.gaSearch=function(b){return this.each(function(){a.data(this,"gaSearch")||a.data(this,"gaSearch",new h(this,b))})}})(jQuery,window,document);
$(function(){$("form.searchFilterForm input[type\x3dtext]").spinner();$("form.searchFilterForm").gaSearch()});